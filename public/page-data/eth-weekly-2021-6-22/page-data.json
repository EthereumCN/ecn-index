{"componentChunkName":"component---src-template-article-js","path":"/eth-weekly-2021-6-22/","result":{"data":{"strapiArticles":{"title":"以太七日谈 • 2021/6/22","summary":"Optimism 将集成多个基础设施；Altair 升级详解","publishDate":"2021-06-22","author":"ECN","authorImg":{"childImageSharp":{"fixed":{"src":"/static/18e33ca02b0130c3f952c7a725931e7a/497c6/ac7e303d9bcf9058c207ba55f49192bb.png"}}},"content":"![cover](https://i.ibb.co/qDJBML1/30.png)\n\n**Gitcoin Grants 第十轮火热进行中**\n开源协作和资助平台 Gitcoin 的第十轮 Grant 已经于6月16日启动，除了常规的基础设施、DApp、社区和 NFT 板块之外，本轮增加了拉丁美洲地区、Gitcoin 建设和 DGOV (去中心化治理) 板块，本轮仍然支持使用二层解决方案 zkSync 进行结算。\n\n![6.22七日谈3](https://i.ibb.co/wKGpxZt/6-22-3.png)\n\n此外，为了提高捐赠的公平性和抗女巫攻击性，Gitcoin 在本轮中开始激励用户进行身份验证，经验证的用户最高能够将其 150% 的捐赠计入匹配资金，而未经验证的用户则默认为 50%。本轮截至时间为 7 月 1 日，在此之前用户都能前往支持优秀的生态项目。\nECN on Gitcoin：https://gitcoin.co/grants/380/ethereumcn-ecn\n\n<br/>\n\n# Eth2\n\n**活动预告：以太坊基金会研究团队即将举行第六次 AMA**\n\n北京时间 6 月 23 日晚上 9 点，以太坊基金会研究团队将在 reddit 论坛举行第六次 AMA。现在已经可以在 reddit 上提前发布问题：https://www.reddit.com/r/ethereum/comments/o4unlp/ama_we_are_the_efs_research_team_pt_6_23_june_2021/\n\n上一期 AMA 整理请阅读：《[以太坊基金会第五次Reddit AMA](https://www.ethereum.cn/ama-we-are-the-efs-eth-20-research-team-pt-5-18)》\n\n<br/>\n\n**Altair 升级讲解**\n\nDanny Ryan 和 Vitalik 在 [PEEPanEIP 系列](https://www.youtube.com/watch?v=iaAEGs1DMgQ) 做了一次关于 Altair 升级即将带来哪些变化的精彩介绍。此期七日谈对 Danny 分享的部分做了编译。\n\n分享概要：\n\n- 惩罚参数更新\n\n  失败模式下更多的惩罚\n\n- 怠工计分机制改革\n\n  更容易从无法做最终敲定的状态恢复，以及更公平\n\n- 同步委员会\n\n  使轻客户端可用的特别角色\n\n  \n\n### 惩罚参数更新\n\n![outline](https://i.ibb.co/YcLKnbR/outline.png)\n\n![punitivity](https://i.ibb.co/tzyV3LG/punitivity-in-altair.png)\n\n根据 EIP-2982，信标链创世时，验证者的惩罚参数与最终设定相比是惩罚力度更小的，因为考虑到给早期的验证者和客户端一个更宽容的环境，鼓励更多的验证者在早期、有更高技术风险的阶段加入。而在 Altair 升级后，怠工惩罚的商从32除以128等于25%，调整为32除以64等于50%，即惩罚从 0.25 个 ETH 变成 0.5 个 ETH。 最终这个惩罚会调整为 1 个 ETH。\n\n`inactivity penalty quotient` （怠工惩罚商）影响的是在区块链因为在线验证者数量不足三分之二无法进行最终确定时对离线状态的验证者的惩罚。这个惩罚现在是比较小的，Altair 升级后这个惩罚会加大一点，这样区块链也能更快恢复到可以进行最终确定的状态。它的设定从`2**26` 变为 `3 * 2**24`，减少了 25%，这应该会缩短 13.4% 的余额扣除时间 (因为扣除时间与这个 quotient的平方根成比例关系)。\n\n`MIN_SLASHING_PENALTY_QUOTIENT` （最低罚没惩罚商）从128变成64。这一点影响的是当你被罚没的时候，你会失去你余额的一部分，通常是 32 除以 128，即 0.25 个 ETH，Altair 升级后是 32 除以64，即 0.5 个 ETH。\n\n`PROPORTIONAL_SLASHING_MULTIPLIER` （成比例罚没乘数）从 1 变成 2。这个乘数是在大型罚没事件中用来保证充分安全性的。在这些事件中，你罚没的数额=初始的罚没惩罚商+在相近罚没时间段与其他验证者数成比例的额外惩罚。在创世时，如果在过去两周里，比如10%的验证者被罚没了，你在这段时间你也被罚没了，那么你的惩罚比例是你余额的10%。Altair 升级后，这个数值就变成 20%。\n\n### 怠工计分机制改革\n\n![phase 0](https://i.ibb.co/8mL8Vg2/phase-0.png)\n\n在阶段 0 ，所有人用的是统一的怠工计分，这导致区块链恢复进行最终确认不稳定，像 Medalla 测试网的情况，而且惩罚一半的在线验证者是非常不公平的。\n\n![altair](https://i.ibb.co/dfkV3GF/altair.png)\n\n在 Altair 升级后，这个机制会用一个数据队列来追踪每个验证者的表现数据。这样可以减少触发无法进行最终确定的机会，对验证者的离线惩罚判断也更公平。\n\n![leak demo](https://i.ibb.co/86C3B2K/leak-demo.png)\n\n![image-20210622144214220](https://i.ibb.co/Tt4wpy5/leak-demo-balance.png)\n\n即使无法进行最终敲定的情况反复出现，那些导致无法敲定的离线验证者的怠工惩罚比率是持续增长的，因为这个机制对每个验证者的离线情况有分别的记录。\n\n![modificatons to the consensus structure](https://i.ibb.co/w0fsVbs/modificatons-to-the-consensus-structure.png)\n\n对共识结构的修改：\n\n添加`inactivity_scores` （怠工计分）列表到 `BeaconState`，以取代之前适用于所有人的计算方法。\n\n把`get_inactivity_penalty_deltas` （获取怠工惩罚差值）改为基于 `inactivity_scores` 列表。\n\n添加每个 epoch 计分变化的 `process_inactivity_updates` （处理怠工更新）。\n\n### sync committes 同步委员会\n\n![sync committee](https://i.ibb.co/SxZGF8j/sync-committee.png)\n\n设置同步委员会是为了让轻客户端作为一等公民！\n\n![validators duties](https://i.ibb.co/mcx42wW/validators-duties.png)\n\n在阶段0，验证者的职责只有区块提议和区块证明。\n\n![new and modify duty](https://i.ibb.co/ThNz8mJ/new-and-modify-duty.png)\n\n新增的同步委员会有以下职责：\n\n- 同步委员会签名 (同步委员会成员对信标区块的每个 slot 签名与广播)\n- 同步委员会聚合 (委员会的一个子集会被选出做聚合交易，并把最佳聚合再广播出去)\n- 同步聚合打包 (提议者密切注意上一个 slot 的最佳聚合来打包，以最大化奖励)\n\n![modificatons to the consensus structure2](https://i.ibb.co/Qvbjz5H/modificatons-to-the-consensus-structure2.png)\n\n对共识结构的修改：\n\n添加 `sync_aggregate` （同步聚合）和 `BeaconBlockBody` （信标区块主体）来记录签名和奖励参与。`sync_aggregate`  是关于谁参与了以及BLS签名。\n\n添加 `sync_committee` 到 `BeaconState`，用于简化轻客户端。\n\n添加`process_sync_committee`到函数 `process_block`，以验证同步聚合交易的数据，包括谁参与了，签名是否有效，是否指向前一个信标区块，然后给参与者与提议者发小额奖励。\n\n添加`process_sync_committee_updates` （处理同步委员会更新）到 `process_epoch` ，大概每天更新同步委员会的变更数据。\n\n视频：https://www.youtube.com/watch?v=iaAEGs1DMgQ\n\n参考 Vitalik 的注释规范：https://github.com/ethereum/annotated-spec/blob/master/altair/beacon-chain.md#beacon-state-mutators\n\n<br/>\n\n## Eth1\n\n**伦敦升级测试网发布时间**\n\n目前只计划了测试网 (Ropsten, Goerli, Rinkeby) 的伦敦升级时间。一旦此次升级在这些测试网络成功启动，就会确定以太坊主网的升级区块。发布计划和客户端版本如下：\n\n![image-20210622191204https://i.ibb.co/mb5FXj8/6-22-1.png772](https://i.ibb.co/mb5FXj8/6-22-1.png)\n\n![6.22七日谈2](https://i.ibb.co/ydTPswh/6-22-2.png)\n\n关于伦敦升级测试网的更多内容请阅读《[伦敦测试网公告](https://www.ethereum.cn/Eth1.x/london-testnets-announcement)》。\n\n<br/>\n\n**EIP-1559 中烧毁 ETH 是什么体验？**\n\n工程师@mohamedmansour 因应社区想看烧毁 ETH 的愿望，他搭建了[http://watchtheburn.com](https://t.co/0hooTlFCNb?amp=1)，内容包括：\n\n- 新的首页有实时烧毁的数据\n- 新页面包括区块、交易和账户\n- 全新的设计\n\n来源：https://twitter.com/mohamedmansour/status/1406948839773261829?s=20\n\n<br/>\n\n# Layer2\n\n**区块链数据索引项目 The Graph 将为以太坊扩容解决方案 Optimism 提供支持**\n\n6 月 18 日，The Graph 宣布与 Optimism 达成合作：为在 Optimistic Ethereum L2 上构建应用的开发者提供数据索引和查询服务。一旦 Optimism 公开发布，The Graph 即上线其为 Optimism 提供的服务，为 Optimism 社区的开发者提供支持。准备在 Optimistic Ethereum 上构建应用的开发者现在就可以通过 The Graph Foundation 获得资助，例如使用 Optimism 和 The Graph 构建 dApps、开发 subgraph 工具或者制作教育资料。\n\n在过去的几个月里，The Graph 为 19+ 个基于 EVM 的解决方案提供支持。其中包括扩容解决方案 Polygon (2 月份完成集成) 和 Arbitrum (6 月)，很快 Optimism 也会加入。\n\n在 Optimistic Ethereum 上集成 The Graph 意味着 Optimism 的开发者将更加容易地访问链上数据，这使得开发者共享开放 APIs、调用 subgraphs 更加容易。\n\n来源：https://thegraph.com/blog/graph-optimistic-ethereum\n\n<br/>\n\n**ConsenSys 旗下产品 Infura、Truffle、MetaMask 将为 Optimism 提供支持**\n\n6 月 17 日，区块链技术研发公司 ConsenSys 宣布为以太坊扩容解决方案 Optimism 提供支持。ConsenSys 的开发者套件使得去中心化网络上的开发与在现代云平台一样简单，ConsenSys 旗下的产品如以太坊开发工具 Infura、Truffle 和去中心化钱包 MetaMask 将为 Optimism 提供支持。首先，Infura 将为 Optimism 上的开发者提供 API 服务。其次，Truffle 也将为 Optimism 社区构建所有部署、测试以及运行应用程序所需的工具。并且 Truffle Box 也快推出了，它将简化在 Optimistic Ethereum 上部署应用程序的过程。最后，当用户需要添加 Optimistic Ethereum 的终端至其钱包上时，MetaMask 将为用户提供更方便的确认方式。\n\n来源：https://consensys.net/blog/press-release/infura-truffle-and-metamask-to-support-optimistic-ethereum/\n\n<br/>\n\n**以太坊状态通道扩容解决方案 Raiden Network 发布 Raiden Light Client \"Ashvini\"**\n\n\"Ashvini\" 是 Raiden Light Client (轻客户端) 在以太坊主网上发布的首个版本。它是基于 Typescript 编写的 Raiden 的完整实现，它可以在任何支持以太坊的浏览器中运行。Raiden Light Client 的功能与特性和 Raiden Python 客户端版本相同。基本的功能有：\n\n(编者注：上期七日谈简要介绍了 Raiden Python 客户端)\n\n- 创建通道\n- 存款至通道\n- 从通道中提出部分存款 (不需要关闭通道)\n- 关闭通道\n- 设置通道\n- 发送直接转账\n- 发送间接转账\n- 接收转账 (接收方节点需要在线)\n- 间接转账\n\nLight Client 链接：http://lightclient.raiden.network/\n\n来源：https://raiden-network.medium.com/announcing-the-raiden-light-client-ashvini-release-60d2a66b0d4\n\n<br/>\n\n**L2 Beat 增加对以太坊扩容解决方案 Arbitrum 锁仓资产的追踪**\n\n此前，Layer2 扩容解决方案 Arbitrum Rollup 的合约于 5 月 28 日部署至主网，并面向开发者开放。\n\n![6.22七日谈6](https://i.ibb.co/ph4XQt6/6-22-6.png)\n\n来源：https://l2beat.com/\n\n<br/>\n\n## 生态\n\n**Republic Realm 基金刷新虚拟土地购买记录**\n6 月 18 日，投资平台 Republic 旗下的 Republic Realm 虚拟地产基金以超过 91.3 万美元 (1,295,000 MANA) 的总价购入 Decentraland 中编号为 #4247 的地皮，在不到一个月的时间里刷新了月初 Boson Protocol 创下的 70.4 万美元记录。虚拟地产是 NFT 领域中的一种独特用例，用户能够购买并拥有虚拟世界中的土地，例如在 Decentraland 中，用户可以在自有土地上进行建设和开发。\n\n![6.22七日谈4](https://i.ibb.co/3v9HHLt/6-22-4.png)\n\n图注：Republic Realm 所购 Decentraland 土地\n\n来源：https://twitter.com/joinrepublic_RE/status/1405579575417991170\n\n<br/>\n\n**Flashbots 中 MEV 支付占交易费用的百分比呈上升趋势**\n\nFlashbots 的研究员 Robert Miller 在推特中发布了一张关于 MEV 的统计图表 —— Flashbots 的 MEV 支付占一周平均交易费用的百分比。注意：该图表多少有点低估了交易费用，并且只统计了 Flashbots 的区块，但是这个趋势是比较明显的。\n\n![6.22七日谈5](https://i.ibb.co/F7VZCbr/6-22-5.jpg)\n\nRobert Miller 指出，五月份的比例上升很可能有两个原因：1、市场波动；2、交易捆。\n\n除此之外，Robert 还发现 MEV 在矿工赚取的费用中所占比例越来越高，这在 gas 费下降的情况下尤其有趣。\n\n来源：https://twitter.com/bertcmiller/status/1405236836105064458\n\n","cover":{"childImageSharp":{"resize":{"src":"/static/66a1b01256795a8db63db75f4e581724/497c6/a8ac179452d4a65b2def3f67474e5186.png"}}}},"site":{"siteMetadata":{"title":"Ethereum Community Network","description":"以太坊——全球的、开源的去中心化应用平台。DeFi？NFT？游戏？虚拟世界？每一个人都可以成为以太坊的开发者和用户！","author":"@ECN以太坊社区网络","keywords":"以太坊,以太坊中国,Ethereum","siteLanguage":"zh-CN","siteLocale":"zh-cn","siteUrl":"http://ethereum.cn","twitterUsername":"@EthereumCN"}}},"pageContext":{"id":"Articles_290"}},"staticQueryHashes":["1238767529","2940180826"]}